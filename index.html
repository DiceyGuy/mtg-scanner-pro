<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîÆ MTG Scanner Pro</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif; }
        .animate-spin { animation: spin 1s linear infinite; }
        .animate-pulse { animation: pulse 2s infinite; }
        .animate-bounce { animation: bounce 1s infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .5; } }
        @keyframes bounce { 0%, 100% { transform: translateY(-25%); } 50% { transform: none; } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        // Simple MTG Scanner Component
        function MTGScanner() {
            const [activeTab, setActiveTab] = useState('scanner');
            const [isScanning, setIsScanning] = useState(false);
            const [recognizedCard, setRecognizedCard] = useState(null);
            const [collection, setCollection] = useState([]);
            const [searchQuery, setSearchQuery] = useState('');
            const [searchResults, setSearchResults] = useState([]);
            const [isLoading, setIsLoading] = useState(false);
            
            const videoRef = useRef(null);
            const fileInputRef = useRef(null);

            // Sample cards
            const cards = [
                { 
                    id: '1', 
                    name: 'Lightning Bolt', 
                    cost: '{R}', 
                    type: 'Instant',
                    rarity: 'Common', 
                    text: 'Lightning Bolt deals 3 damage to any target.',
                    price: 0.50
                },
                { 
                    id: '2', 
                    name: 'Black Lotus', 
                    cost: '{0}', 
                    type: 'Artifact',
                    rarity: 'Mythic Rare', 
                    text: '{T}, Sacrifice Black Lotus: Add three mana of any one color.',
                    price: 27000.00
                },
                { 
                    id: '3', 
                    name: 'Jace, the Mind Sculptor', 
                    cost: '{2}{U}{U}', 
                    type: 'Legendary Planeswalker',
                    rarity: 'Mythic Rare', 
                    text: '+2: Look at the top card of target player\'s library.',
                    price: 89.99
                },
                { 
                    id: '4', 
                    name: 'Counterspell', 
                    cost: '{U}{U}', 
                    type: 'Instant',
                    rarity: 'Common', 
                    text: 'Counter target spell.',
                    price: 2.50
                }
            ];

            // Start camera
            const startCamera = async () => {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ 
                        video: { facingMode: 'environment' } 
                    });
                    if (videoRef.current) {
                        videoRef.current.srcObject = stream;
                        setIsScanning(true);
                    }
                } catch (err) {
                    console.error('Camera failed:', err);
                }
            };

            // Stop camera
            const stopCamera = () => {
                if (videoRef.current && videoRef.current.srcObject) {
                    const tracks = videoRef.current.srcObject.getTracks();
                    tracks.forEach(track => track.stop());
                    videoRef.current.srcObject = null;
                }
                setIsScanning(false);
            };

            // Simulate AI scan
            const scanCard = async () => {
                setIsLoading(true);
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                const randomCard = cards[Math.floor(Math.random() * cards.length)];
                setRecognizedCard({
                    ...randomCard,
                    confidence: Math.floor(Math.random() * 20) + 80
                });
                setIsLoading(false);
            };

            // Add to collection
            const addToCollection = (card) => {
                const existing = collection.find(c => c.id === card.id);
                if (existing) {
                    setCollection(collection.map(c => 
                        c.id === card.id ? {...c, quantity: c.quantity + 1} : c
                    ));
                } else {
                    setCollection([...collection, {...card, quantity: 1}]);
                }
            };

            // Remove from collection
            const removeFromCollection = (cardId) => {
                setCollection(collection.filter(c => c.id !== cardId));
            };

            // Search cards
            const searchCards = (query) => {
                if (!query.trim()) {
                    setSearchResults([]);
                    return;
                }
                
                const results = cards.filter(card =>
                    card.name.toLowerCase().includes(query.toLowerCase()) ||
                    card.type.toLowerCase().includes(query.toLowerCase())
                );
                setSearchResults(results);
            };

            // Format price
            const formatPrice = (price) => {
                if (price >= 1000) return `$${(price/1000).toFixed(1)}k`;
                return `$${price.toFixed(2)}`;
            };

            // Get rarity color
            const getRarityColor = (rarity) => {
                switch(rarity) {
                    case 'Common': return 'text-gray-400';
                    case 'Uncommon': return 'text-blue-400';
                    case 'Rare': return 'text-yellow-400';
                    case 'Mythic Rare': return 'text-red-400';
                    default: return 'text-gray-400';
                }
            };

            // Search effect
            useEffect(() => {
                const timeoutId = setTimeout(() => searchCards(searchQuery), 300);
                return () => clearTimeout(timeoutId);
            }, [searchQuery]);

            const totalValue = collection.reduce((sum, card) => sum + (card.price * card.quantity), 0);
            const totalCards = collection.reduce((sum, card) => sum + card.quantity, 0);

            return (
                <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 text-white">
                    {/* Header */}
                    <div className="bg-black/40 backdrop-blur-lg border-b border-white/20 p-4">
                        <div className="max-w-6xl mx-auto flex justify-between items-center">
                            <div className="flex items-center gap-4">
                                <div className="w-12 h-12 bg-gradient-to-r from-purple-500 to-cyan-500 rounded-xl flex items-center justify-center">
                                    <span className="text-2xl">üîÆ</span>
                                </div>
                                <div>
                                    <h1 className="text-2xl font-bold bg-gradient-to-r from-purple-400 to-cyan-400 bg-clip-text text-transparent">
                                        MTG Scanner Pro
                                    </h1>
                                    <p className="text-sm text-gray-300">üß† AI Card Recognition</p>
                                </div>
                            </div>
                            <div className="text-right">
                                <div className="text-sm text-gray-400">Collection</div>
                                <div className="text-lg font-bold text-blue-400">{totalCards} cards</div>
                                <div className="text-lg font-bold text-green-400">{formatPrice(totalValue)}</div>
                            </div>
                        </div>
                    </div>

                    {/* Navigation */}
                    <div className="max-w-6xl mx-auto p-4">
                        <div className="flex gap-2 bg-black/30 rounded-2xl p-2 backdrop-blur-lg">
                            {[
                                { id: 'scanner', label: 'üì∑ Scanner' },
                                { id: 'search', label: 'üîç Search' },
                                { id: 'collection', label: 'üìö Collection' }
                            ].map(tab => (
                                <button
                                    key={tab.id}
                                    onClick={() => setActiveTab(tab.id)}
                                    className={`flex-1 py-3 px-4 rounded-xl transition-all ${
                                        activeTab === tab.id 
                                            ? 'bg-gradient-to-r from-blue-600 to-purple-600 text-white' 
                                            : 'text-gray-400 hover:text-white hover:bg-white/10'
                                    }`}
                                >
                                    {tab.label}
                                </button>
                            ))}
                        </div>
                    </div>

                    <div className="max-w-6xl mx-auto px-4 pb-8">
                        {/* Scanner Tab */}
                        {activeTab === 'scanner' && (
                            <div className="bg-black/30 rounded-2xl p-6 backdrop-blur-lg">
                                <h2 className="text-2xl font-bold mb-6">üß† AI Card Scanner</h2>
                                
                                <div className="grid lg:grid-cols-2 gap-8">
                                    <div className="space-y-4">
                                        {/* Video Display */}
                                        <div className="bg-black rounded-xl overflow-hidden border-2 border-purple-500/30 relative">
                                            <video 
                                                ref={videoRef} 
                                                autoPlay 
                                                playsInline 
                                                muted
                                                className="w-full h-80 object-cover"
                                                style={{ display: isScanning ? 'block' : 'none' }}
                                            />
                                            {!isScanning && (
                                                <div className="w-full h-80 bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center">
                                                    <div className="text-center">
                                                        <div className="text-6xl mb-4 animate-bounce">üì∑</div>
                                                        <p className="text-purple-400 text-xl font-bold">AI Ready</p>
                                                        <p className="text-gray-400">Click to start camera</p>
                                                    </div>
                                                </div>
                                            )}
                                            
                                            {/* Loading Overlay */}
                                            {isLoading && (
                                                <div className="absolute inset-0 bg-black/80 flex items-center justify-center">
                                                    <div className="text-center">
                                                        <div className="w-16 h-16 border-4 border-cyan-200 border-t-cyan-500 rounded-full animate-spin mx-auto mb-4"></div>
                                                        <p className="text-cyan-400 text-xl font-bold">üß† AI Processing</p>
                                                    </div>
                                                </div>
                                            )}
                                        </div>
                                        
                                        {/* Controls */}
                                        <div className="space-y-3">
                                            {!isScanning ? (
                                                <button 
                                                    onClick={startCamera}
                                                    className="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-6 py-4 rounded-xl font-bold text-lg"
                                                >
                                                    üöÄ Start Camera
                                                </button>
                                            ) : (
                                                <div className="flex gap-3">
                                                    <button 
                                                        onClick={scanCard}
                                                        disabled={isLoading}
                                                        className="flex-1 bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 disabled:opacity-50 text-white px-6 py-4 rounded-xl font-bold text-lg"
                                                    >
                                                        {isLoading ? 'üß† Scanning...' : '‚ö° Scan Card'}
                                                    </button>
                                                    <button 
                                                        onClick={stopCamera}
                                                        className="px-6 py-4 bg-red-600 hover:bg-red-700 text-white rounded-xl font-bold"
                                                    >
                                                        Stop
                                                    </button>
                                                </div>
                                            )}
                                            
                                            <input
                                                ref={fileInputRef}
                                                type="file"
                                                accept="image/*"
                                                className="hidden"
                                            />
                                            <button 
                                                onClick={() => fileInputRef.current?.click()}
                                                className="w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white px-6 py-4 rounded-xl font-bold text-lg"
                                            >
                                                üìÅ Upload Image
                                            </button>
                                        </div>
                                    </div>
                                    
                                    {/* Results */}
                                    <div>
                                        {recognizedCard ? (
                                            <div className="bg-gray-800/50 rounded-xl p-6 border border-gray-700/50">
                                                <div className="flex justify-between items-start mb-4">
                                                    <div>
                                                        <h3 className="text-2xl font-bold text-white mb-2">{recognizedCard.name}</h3>
                                                        <div className="flex items-center gap-3 mb-2">
                                                            <span className="text-blue-400 font-mono bg-blue-400/10 px-2 py-1 rounded">{recognizedCard.cost}</span>
                                                            <span className={`${getRarityColor(recognizedCard.rarity)} font-bold`}>{recognizedCard.rarity}</span>
                                                        </div>
                                                        <p className="text-gray-400">{recognizedCard.type}</p>
                                                    </div>
                                                    <div className="text-right">
                                                        <div className="text-3xl font-bold text-green-400">{formatPrice(recognizedCard.price)}</div>
                                                        <div className="text-sm text-cyan-400">{recognizedCard.confidence}% confident</div>
                                                    </div>
                                                </div>
                                                
                                                <div className="bg-gray-900/50 rounded-lg p-4 mb-4">
                                                    <p className="text-gray-300">{recognizedCard.text}</p>
                                                </div>
                                                
                                                <button 
                                                    onClick={() => addToCollection(recognizedCard)}
                                                    className="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-4 py-3 rounded-lg font-bold"
                                                >
                                                    ‚≠ê Add to Collection
                                                </button>
                                            </div>
                                        ) : (
                                            <div className="bg-gray-800/30 rounded-xl p-8 text-center border-2 border-dashed border-gray-600">
                                                <div className="text-6xl mb-4 animate-pulse">üëÅÔ∏è</div>
                                                <p className="text-purple-400 text-xl font-bold mb-2">üß† AI Ready</p>
                                                <p className="text-gray-400">Scan or upload a card image</p>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Search Tab */}
                        {activeTab === 'search' && (
                            <div className="bg-black/30 rounded-2xl p-6 backdrop-blur-lg">
                                <h2 className="text-2xl font-bold mb-6">üîç Card Search</h2>
                                
                                <input
                                    type="text"
                                    placeholder="Search cards..."
                                    value={searchQuery}
                                    onChange={(e) => setSearchQuery(e.target.value)}
                                    className="w-full p-4 bg-gray-800/50 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:border-purple-500 focus:outline-none mb-6"
                                />
                                
                                {searchQuery === '' ? (
                                    <div className="text-center py-16">
                                        <div className="text-6xl mb-4 animate-bounce">üîç</div>
                                        <p className="text-purple-400 text-xl font-bold">Search Magic Cards</p>
                                        <p className="text-gray-400">Try "Lightning Bolt" or "Jace"</p>
                                    </div>
                                ) : searchResults.length > 0 ? (
                                    <div className="grid gap-4">
                                        {searchResults.map(card => (
                                            <div key={card.id} className="bg-gray-800/50 rounded-xl p-4 border border-gray-700/50">
                                                <div className="flex justify-between items-start mb-3">
                                                    <div>
                                                        <h3 className="text-xl font-bold text-white mb-1">{card.name}</h3>
                                                        <div className="flex items-center gap-2 mb-1">
                                                            <span className="text-blue-400 font-mono text-sm bg-blue-400/10 px-2 py-1 rounded">{card.cost}</span>
                                                            <span className={`${getRarityColor(card.rarity)} font-bold text-sm`}>{card.rarity}</span>
                                                        </div>
                                                        <p className="text-gray-400 text-sm">{card.type}</p>
                                                    </div>
                                                    <div className="text-xl font-bold text-green-400">{formatPrice(card.price)}</div>
                                                </div>
                                                <div className="bg-gray-900/50 rounded-lg p-3 mb-3">
                                                    <p className="text-gray-300 text-sm">{card.text}</p>
                                                </div>
                                                <button 
                                                    onClick={() => addToCollection(card)}
                                                    className="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-4 py-2 rounded-lg font-bold"
                                                >
                                                    ‚≠ê Add to Collection
                                                </button>
                                            </div>
                                        ))}
                                    </div>
                                ) : (
                                    <div className="text-center py-16">
                                        <div className="text-4xl mb-4">üòî</div>
                                        <p className="text-gray-400 text-lg">No cards found for "{searchQuery}"</p>
                                    </div>
                                )}
                            </div>
                        )}

                        {/* Collection Tab */}
                        {activeTab === 'collection' && (
                            <div className="bg-black/30 rounded-2xl p-6 backdrop-blur-lg">
                                <div className="flex justify-between items-center mb-8">
                                    <h2 className="text-2xl font-bold">üìö Your Collection</h2>
                                    <div className="text-right">
                                        <div className="text-3xl font-bold text-green-400">{formatPrice(totalValue)}</div>
                                        <div className="text-gray-400">Total Value</div>
                                    </div>
                                </div>
                                
                                {collection.length > 0 ? (
                                    <div className="grid gap-4">
                                        {collection.map(card => (
                                            <div key={card.id} className="bg-gray-800/50 rounded-xl p-4 border border-gray-700/50">
                                                <div className="flex justify-between items-start mb-3">
                                                    <div>
                                                        <h3 className="text-xl font-bold text-white mb-1">{card.name}</h3>
                                                        <div className="flex items-center gap-2 mb-1">
                                                            <span className="text-blue-400 font-mono text-sm bg-blue-400/10 px-2 py-1 rounded">{card.cost}</span>
                                                            <span className={`${getRarityColor(card.rarity)} font-bold text-sm`}>{card.rarity}</span>
                                                            <span className="text-gray-300 bg-gray-700/30 px-2 py-1 rounded text-sm">Qty: {card.quantity}</span>
                                                        </div>
                                                        <p className="text-gray-400 text-sm">{card.type}</p>
                                                    </div>
                                                    <div className="text-right">
                                                        <div className="text-xl font-bold text-green-400">{formatPrice(card.price * card.quantity)}</div>
                                                        <div className="text-sm text-gray-400">{formatPrice(card.price)} each</div>
                                                    </div>
                                                </div>
                                                <div className="bg-gray-900/50 rounded-lg p-3 mb-3">
                                                    <p className="text-gray-300 text-sm">{card.text}</p>
                                                </div>
                                                <div className="flex gap-2">
                                                    <button 
                                                        onClick={() => addToCollection(card)}
                                                        className="flex-1 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-bold"
                                                    >
                                                        ‚ûï Add
                                                    </button>
                                                    <button 
                                                        onClick={() => removeFromCollection(card.id)}
                                                        className="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-bold"
                                                    >
                                                        üóëÔ∏è
                                                    </button>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                ) : (
                                    <div className="text-center py-16">
                                        <div className="text-6xl mb-4 animate-bounce">üìö</div>
                                        <p className="text-purple-400 text-xl font-bold mb-4">Start Your Collection</p>
                                        <p className="text-gray-400 mb-8">Scan or search for cards</p>
                                        <div className="flex gap-4 justify-center">
                                            <button 
                                                onClick={() => setActiveTab('scanner')}
                                                className="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-6 py-3 rounded-xl font-bold"
                                            >
                                                üì∑ Start Scanning
                                            </button>
                                            <button 
                                                onClick={() => setActiveTab('search')}
                                                className="bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white px-6 py-3 rounded-xl font-bold"
                                            >
                                                üîç Search Cards
                                            </button>
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // Initialize App
        ReactDOM.render(React.createElement(MTGScanner), document.getElementById('root'));
    </script>
</body>
</html>
